<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml" xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:h="http://java.sun.com/jsf/html" xmlns:f="http://java.sun.com/jsf/core"
                xmlns:rich="http://richfaces.org/rich" xmlns:cu="http://java.sun.com/jsf/composite/components" xmlns:a4j="http://richfaces.org/a4j"
                xmlns:itc="http://it-crowd.com.pl/jsf" xmlns:s="http://jboss.org/seam/faces" template="/layout/template.xhtml">
    <f:metadata>
        <s:viewAction action="#{categoryListView.initView}"/>
    </f:metadata>

    <ui:param name="activeStyleAdmin" value="PRODUCTCATEGORIES"/>

    <ui:define name="body">

        <cu:underlinedHeader value="#{messages['view.myAccount.header']}"/>

        <!-- content area -->

        <div class="span12">

            <ui:include src="/layout/myAccountNav.xhtml"/>

            <div class="row-fluid">

                <ui:include src="/layout/myAccountAdminNav.xhtml"/>

                <div class="span9">

                    <h:form id="settTable" styleClass="form-horizontal">
                        <div class="row-fluid">
                            <div class="span6"><h4>#{messages['view.categories.categories']}</h4></div>
                            <div class="span6"><h4>#{messages['view.categories.childCat']}</h4></div>
                        </div>
                        <div class="row-fluid">
                            <h:selectOneListbox id="parentCategories" size="6" value="#{categoryListView.selectedCategory}" styleClass="span6">

                                <f:selectItems value="#{categoryListView.productParentCategories}" var="category" itemValue="#{category}" itemLabel="#{category.name}"/>
                                <itc:convertEntity/>
                                <a4j:ajax event="change" execute="@this" render="childCategories inC delG c2 delCG"/>
                            </h:selectOneListbox>
                            <h:selectOneListbox id="childCategories" size="6" value="#{categoryListView.selectedChildCategory}" styleClass="span6">
                                <f:selectItems value="#{categoryListView.productChildCategories}" var="categoryC" itemValue="#{categoryC}" itemLabel="#{categoryC.name}"/>
                                <itc:convertEntity/>
                                <a4j:ajax event="click" execute="@this" render="inC delCG"/>
                            </h:selectOneListbox>
                        </div>
                        <div class="row-fluid marginTop20">
                            <div class="span6">
                                <a4j:commandButton id="c1" value="#{messages['CRUD.new']}" action="#{categoryListView.newCategory}" render="inC"
                                                   styleClass="btn btn-info marginLeft10"/>
                                <h:panelGroup id="delG">
                                    <a4j:commandButton id="c3" value="#{messages['CRUD.deleteSelected']}" onclick="#{rich:component('confirmChanges')}.show();"
                                                       rendered="#{categoryListView.productsForCategories}" styleClass=" btn btn-danger marginLeft10"/>
                                    <a4j:commandButton id="c4" value="#{messages['CRUD.deleteSelected']}" action="#{categoryListView.delete}"
                                                       styleClass="btn btn-danger marginLeft10" render="parentCategories childCategories inC"
                                                       rendered="#{not categoryListView.productsForCategories}"/>
                                </h:panelGroup>

                            </div>

                            <div class="span6">
                                <a4j:commandButton id="c2" value="#{messages['CRUD.new']}" action="#{categoryListView.newChildCategory}" render="inC"
                                                   disabled="#{empty categoryListView.selectedCategory}" styleClass="btn btn-info"/>

                                <h:panelGroup id="delCG">
                                    <a4j:commandButton id="c33" value="#{messages['CRUD.deleteSelected']}" onclick="#{rich:component('confirmChanges')}.show();"
                                                       styleClass="btn btn-danger marginLeft10" rendered="#{categoryListView.productsForChildCategory}"
                                                       disabled="#{categoryListView.unselectedChild}"/>
                                    <a4j:commandButton id="c44" value="#{messages['CRUD.deleteSelected']}" render="childCategories inC" styleClass="btn btn-danger marginLeft10"
                                                       rendered="#{not categoryListView.productsForChildCategory}" disabled="#{categoryListView.unselectedChild}"
                                                       action="#{categoryListView.deleteChild}"/>

                                </h:panelGroup>
                            </div>
                        </div>
                        <div class="row-fluid marginTop40">
                            <div class="span12">
                                <cu:edit label="#{messages['CRUD.choosenElement']}">
                                    <h:inputText id="inC" value="#{categoryListView.editedCategory.name}" styleClass="inputCrudAdmin"/>
                                    <a4j:commandButton value="Save" action="#{categoryListView.save}" styleClass="btn btn-info marginLeft10"
                                                       render="parentCategories childCategories" execute="inC"/>
                                </cu:edit>
                            </div>
                        </div>
                        <div class="form-actions"></div>
                        <rich:popupPanel id="confirmChanges" modal="true" autosized="true" styleClass="popup">
                            <p class="modal-header row-bold">#{messages['CRUD.warning']}</p>

                            <p class="modal-header row-bold">You can't remove this category, because exists products assign to this category!</p>
                            <h:form>
                                <a4j:commandButton value="#{messages['CRUD.continue']}" onclick="#{rich:component('confirmChanges')}.hide()" styleClass="btn btn-info pull-left"/>
                            </h:form>
                        </rich:popupPanel>
                    </h:form>

                </div>
            </div>
        </div>
    </ui:define>
</ui:composition>