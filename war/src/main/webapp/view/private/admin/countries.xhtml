<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml" xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:h="http://java.sun.com/jsf/html" xmlns:f="http://java.sun.com/jsf/core"
                xmlns:rich="http://richfaces.org/rich" xmlns:cu="http://java.sun.com/jsf/composite/components" xmlns:a4j="http://richfaces.org/a4j"
                xmlns:itc="http://it-crowd.com.pl/jsf" xmlns:s="http://jboss.org/seam/faces" template="/layout/template.xhtml">
    <f:metadata>
        <s:viewAction action="#{countryListView.initView}"/>
    </f:metadata>

    <ui:param name="activeStyleAdmin" value="COUNTRIES"/>

    <ui:define name="body">

        <cu:underlinedHeader value="#{messages['view.myAccount.header']}"/>

        <!-- content area -->

        <div class="span12">

            <ui:include src="/layout/myAccountNav.xhtml"/>

            <div class="row-fluid">

                <ui:include src="/layout/myAccountAdminNav.xhtml"/>

                <div class="span9">

                    <h:form id="settTable" styleClass="form-horizontal">

                        <div class="row-fluid">
                            <div class="span6"><h4>#{messages['view.countries.countries']}</h4></div>
                            <div class="span6"><h4>#{messages['view.countries.regions']}</h4></div>
                        </div>
                        <div class="row-fluid">
                            <h:selectOneListbox id="countries" size="6" value="#{countryListView.selectedCountry}" styleClass="span6">
                                <f:selectItems value="#{countryListView.allCountries}" var="country" itemValue="#{country}" itemLabel="#{country.name}"/>
                                <itc:convertEntity/>
                                <a4j:ajax event="change" execute="@this" render="regions delG inG inC1 delCG" listener="#{countryListView.uncheckRegion}"/>
                            </h:selectOneListbox>
                            <h:selectOneListbox id="regions" size="6" value="#{countryListView.selectedCountryRegion}" styleClass="span6">
                                <f:selectItems value="#{countryListView.selectedCountry.regions}" var="region" itemValue="#{region}" itemLabel="#{region.name}"/>
                                <itc:convertEntity/>
                                <a4j:ajax event="click" execute="@this" render="delCG inG"/>
                            </h:selectOneListbox>
                        </div>
                        <div class="row-fluid marginTop20">
                            <div class="span6">
                                <a4j:commandButton id="c1" value="#{messages['view.countries.newCountry']}" action="#{countryListView.newCountry}"
                                                   styleClass="btn btn-info marginLeft10" render="inG"/>
                                <h:panelGroup id="delG">
                                    <a4j:commandButton id="c3" value="#{messages['CRUD.delete']}" onclick="#{rich:component('confirmChanges')}.show();"
                                                       rendered="#{countryListView.userForCountry}" styleClass="btn btn-danger marginLeft10"/>
                                    <a4j:commandButton id="c4" value="#{messages['CRUD.delete']}" action="#{countryListView.deleteCountry}" render="countries regions inG"
                                                       rendered="#{not countryListView.userForCountry}" styleClass="btn btn-danger marginLeft10"/>
                                </h:panelGroup>
                            </div>
                            <div class="span6">
                                <a4j:commandButton id="c2" value="#{messages['view.countries.newRegion']}" action="#{countryListView.newRegion}" styleClass="btn btn-info"
                                                   render="inG" disabled="#{empty countryListView.selectedRegion}"/>

                                <h:panelGroup id="delCG">
                                    <a4j:commandButton id="c33" value="#{messages['view.countries.deleteSelectedRegion']}" onclick="#{rich:component('confirmChanges')}.show();"
                                                       rendered="#{countryListView.userForRegion}" disabled="#{countryListView.unselectedRegion}"
                                                       styleClass="btn btn-danger marginLeft10"/>
                                    <a4j:commandButton id="c44" value="#{messages['view.countries.deleteSelectedRegion']}" render="regions inG"
                                                       rendered="#{not countryListView.userForRegion}" disabled="#{countryListView.unselectedRegion}"
                                                       styleClass="btn btn-danger marginLeft10" action="#{countryListView.deleteRegion}"/>
                                </h:panelGroup>
                            </div>
                        </div>
                        <div class="row-fluid marginTop40">
                            <h:panelGroup id="inG">
                                <cu:edit label="#{messages['CRUD.choosenElement']}">
                                    <h:inputText id="inC1" value="#{countryListView.editedCountryHome.name}" styleClass="inputCrudAdmin"
                                                 rendered="#{not countryListView.selectedRegion}"/>
                                    <h:inputText id="inC2" value="#{countryListView.editedRegionHome.name}" styleClass="inputCrudAdmin"
                                                 rendered="#{countryListView.selectedRegion}"/>
                                    <a4j:commandButton value="#{messages['CRUD.save']}" action="#{countryListView.save}" styleClass="btn btn-info marginLeft10"
                                                       render="countries regions" execute="inG"/>
                                </cu:edit>
                            </h:panelGroup>
                        </div>
                        <div class="form-actions"></div>

                        <rich:popupPanel id="confirmChanges" modal="true" autosized="true" styleClass="popup">
                            <p class="modal-header row-bold">#{messages['CRUD.warning']}</p>

                            <p class="modal-header row-bold">#{messages['view.country.warning']}</p>
                            <h:form>
                                <a4j:commandButton value="#{messages['CRUD.continue']}" onclick="#{rich:component('confirmChanges')}.hide()" styleClass="btn btn-info pull-left"
                                                   render="parentCategories"/>
                            </h:form>
                        </rich:popupPanel>
                    </h:form>

                </div>
            </div>
        </div>
    </ui:define>
</ui:composition>